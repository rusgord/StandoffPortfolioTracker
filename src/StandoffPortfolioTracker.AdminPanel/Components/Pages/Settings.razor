@page "/settings"
@using Microsoft.AspNetCore.Identity
@using StandoffPortfolioTracker.Core.Entities
@using System.Security.Claims
@using Microsoft.Extensions.DependencyInjection
@using System.Text.Json
@using StandoffPortfolioTracker.AdminPanel.Services
@inject IServiceScopeFactory ScopeFactory
@inject AuthenticationStateProvider AuthStateProvider
@inject NavigationManager NavManager
@inject IWebHostEnvironment Environment
@inject StandoffPortfolioTracker.AdminPanel.Services.ToastService ToastService
@attribute [Authorize]
@rendermode InteractiveServer

<div class="container py-4" style="max-width: 980px;">
    <div class="d-flex align-items-center justify-content-between mb-4">
        <div>
            <h3 class="fw-bold text-dark m-0">⚙️ Настройки</h3>
            <span class="text-muted small">Управление профилем и приватностью</span>
        </div>
        <a href="profile/@currentUser?.Id" class="btn btn-outline-primary rounded-pill btn-sm fw-bold px-3 d-flex align-items-center gap-2 transition hover-shadow">
            <i class="bi bi-eye"></i> <span>Мой профиль</span>
        </a>
    </div>

    <div class="row g-4">
        <div class="col-lg-3">
            <div class="card border-0 shadow-sm rounded-4 overflow-hidden sticky-top" style="top: 20px; z-index: 1;">
                <div class="list-group list-group-flush p-2">
                    <button class="list-group-item list-group-item-action border-0 rounded-3 py-3 px-3 mb-1 d-flex align-items-center gap-3 @(activeTab == "general" ? "active-tab" : "text-secondary")"
                            @onclick='() => activeTab = "general"'>
                        <i class="bi bi-person-circle fs-5"></i>
                        <span class="fw-bold">Основное</span>
                    </button>

                    <button class="list-group-item list-group-item-action border-0 rounded-3 py-3 px-3 mb-1 d-flex align-items-center gap-3 @(activeTab == "customization" ? "active-tab" : "text-secondary")"
                            @onclick='() => activeTab = "customization"'>
                        <i class="bi bi-palette-fill fs-5"></i>
                        <span class="fw-bold">Кастомизация</span>
                    </button>

                    <button class="list-group-item list-group-item-action border-0 rounded-3 py-3 px-3 mb-1 d-flex align-items-center gap-3 @(activeTab == "privacy" ? "active-tab" : "text-secondary")"
                            @onclick='() => activeTab = "privacy"'>
                        <i class="bi bi-shield-check fs-5"></i>
                        <span class="fw-bold">Приватность</span>
                    </button>

                    <button class="list-group-item list-group-item-action border-0 rounded-3 py-3 px-3 d-flex align-items-center gap-3 @(activeTab == "security" ? "active-tab" : "text-secondary")"
                            @onclick='() => activeTab = "security"'>
                        <i class="bi bi-key-fill fs-5"></i>
                        <span class="fw-bold">Безопасность</span>
                    </button>
                </div>

                <div class="bg-light p-3 border-top mt-2">
                    <small class="text-muted text-uppercase fw-bold" style="font-size: 0.65rem; letter-spacing: 1px;">Публичная ссылка</small>
                    <div class="input-group input-group-sm mt-2">
                        <input type="text" class="form-control border-end-0 bg-white" value="@GetProfileUrl()" readonly style="font-size: 0.8rem; color: #6c757d;" />
                        <button class="btn btn-white border border-start-0 text-primary" onclick="navigator.clipboard.writeText('@GetProfileUrl()')" title="Скопировать">
                            <i class="bi bi-clipboard"></i>
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <div class="col-lg-9">
            <div class="card border-0 shadow-sm rounded-4 h-100">
                <div class="card-body p-4 p-lg-5">

                    @* --- 1. ОСНОВНОЕ (Без изменений) --- *@
                    @if (activeTab == "general")
                    {
                        <h5 class="fw-bold mb-4">👤 Личные данные</h5>
                        @* ... *@

                        <div class="d-flex flex-column flex-md-row align-items-center gap-4 mb-5 p-4 bg-light rounded-4 border border-light">
                            <div class="position-relative">
                                <div class="avatar-preview-container @currentUser.ProfileFrame">
                                    <img src="@(string.IsNullOrEmpty(currentUser?.AvatarUrl) ? "/images/default-avatar.png" : currentUser.AvatarUrl)"
                                         class="rounded-circle shadow-sm object-fit-cover"
                                         style="width: 100%; height: 100%;" />
                                </div>
                                <label class="position-absolute bottom-0 end-0 bg-primary text-white shadow rounded-circle d-flex align-items-center justify-content-center cursor-pointer hover-scale"
                                       style="width: 36px; height: 36px; border: 2px solid white; z-index: 10;">
                                    <i class="bi bi-camera-fill small"></i>
                                    <InputFile OnChange="HandleFileSelected" style="display:none;" accept=".jpg,.jpeg,.png" />
                                </label>
                            </div>
                            <div class="text-center text-md-start">
                                <h6 class="fw-bold mb-1">Фото профиля</h6>
                                <p class="text-muted small mb-0">Поддерживаются форматы JPG, PNG (макс. 2MB).</p>
                            </div>
                        </div>

                        <div class="row g-4">
                            <div class="col-md-6">
                                <div class="form-floating">
                                    <input type="text" class="form-control" id="displayName" @bind="currentUser.DisplayName" placeholder="Имя" />
                                    <label for="displayName">Отображаемое имя</label>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-floating">
                                    <input type="text" class="form-control" id="gameId" @bind="currentUser.StandoffGameId" placeholder="ID" />
                                    <label for="gameId">Standoff 2 ID</label>
                                </div>
                            </div>
                            <div class="col-md-12">
                                <div class="form-floating">
                                    <input type="text" class="form-control bg-light" id="email" value="@currentUser.UserName" disabled readonly />
                                    <label for="email">Логин (Email)</label>
                                </div>
                            </div>
                            <div class="col-12">
                                <label class="form-label fw-bold small text-muted ms-1">Цель портфолио (Gold)</label>
                                <div class="input-group input-group-lg">
                                    <span class="input-group-text bg-white border-end-0 text-warning"><i class="bi bi-crosshair"></i></span>
                                    <InputNumber class="form-control border-start-0 ps-0" @bind-Value="currentUser.PortfolioGoal" step="0.01" placeholder="0.00" />
                                </div>
                            </div>
                        </div>
                        <div class="d-flex justify-content-end mt-5">
                            <button class="btn btn-primary fw-bold px-4 py-2 rounded-pill shadow-sm transition hover-scale" @onclick="SaveChanges">
                                <i class="bi bi-check-lg me-2"></i> Сохранить изменения
                            </button>
                        </div>
                    }

                    @* --- 2. КАСТОМИЗАЦИЯ (Без изменений) --- *@
                    @if (activeTab == "customization")
                    {
                        <h5 class="fw-bold mb-4">🎨 Внешний вид профиля</h5>
                        @* ... *@
                        <div class="mb-5">
                            <label class="form-label fw-bold text-muted small text-uppercase ls-1 mb-3">Рамка аватара</label>
                            <div class="d-flex gap-4 flex-wrap">
                                @foreach (var frame in availableFrames)
                                {
                                    <div class="text-center cursor-pointer" @onclick='() => currentUser.ProfileFrame = frame.Id'>
                                        <div class="avatar-frame-select mb-2 @(currentUser.ProfileFrame == frame.Id ? "selected" : "")">
                                            <div class="frame-preview @frame.Id">
                                                <img src="@(string.IsNullOrEmpty(currentUser?.AvatarUrl) ? "/images/default-avatar.png" : currentUser.AvatarUrl)" />
                                            </div>
                                        </div>
                                        <div class="small fw-bold @(currentUser.ProfileFrame == frame.Id ? "text-primary" : "text-muted")">@frame.Name</div>
                                    </div>
                                }
                            </div>
                        </div>
                        <div class="mb-4">
                            <label class="form-label fw-bold text-muted small text-uppercase ls-1 mb-3">
                                Витрина скинов <span class="badge bg-primary rounded-pill ms-2">Макс. 4</span>
                            </label>
                            @if (userInventory.Any())
                            {
                                <div class="inventory-grid">
                                    @foreach (var item in userInventory)
                                    {
                                        bool isSelected = selectedSkinIds.Contains(item.ItemBaseId);
                                        <div class="skin-selector-card @(isSelected ? "active" : "")"
                                             @onclick="() => ToggleFavoriteSkin(item.ItemBaseId)">
                                            <div class="skin-img">
                                                <img src="@item.ItemBase?.ImageUrl" />
                                            </div>
                                            <div class="skin-name text-truncate">@item.ItemBase?.Name</div>
                                            @if (isSelected)
                                            {
                                                <div class="check-indicator"><i class="bi bi-check"></i></div>
                                            }
                                        </div>
                                    }
                                </div>
                            }
                            else
                            {
                                <div class="alert alert-secondary border-0 rounded-4 text-center py-4">
                                    <i class="bi bi-box-seam fs-1 d-block mb-2 opacity-50"></i>
                                    У вас пока нет предметов в портфолио.
                                    <div class="mt-2"><a href="portfolio" class="fw-bold">Добавить предметы</a></div>
                                </div>
                            }
                        </div>
                        <div class="d-flex justify-content-end mt-4">
                            <button class="btn btn-primary fw-bold px-4 py-2 rounded-pill shadow-sm transition hover-scale" @onclick="SaveChanges">
                                <i class="bi bi-palette me-2"></i> Применить стиль
                            </button>
                        </div>
                    }

                    @* --- 3. ПРИВАТНОСТЬ (Без изменений) --- *@
                    @if (activeTab == "privacy")
                    {
                        <h5 class="fw-bold mb-4">🔒 Приватность</h5>
                        @* ... *@
                        <div class="bg-primary bg-opacity-10 p-4 rounded-4 mb-4 border border-primary border-opacity-10">
                            <div class="d-flex justify-content-between align-items-center">
                                <div>
                                    <h6 class="fw-bold mb-1 text-primary"><i class="bi bi-globe me-2"></i> Публичный профиль</h6>
                                    <p class="small text-muted mb-0">Если выключено, ваш профиль будет скрыт от всех.</p>
                                </div>
                                <div class="form-check form-switch">
                                    <input class="form-check-input fs-4 shadow-none" type="checkbox" id="publicProfile" @bind="currentUser.IsProfilePublic" style="cursor: pointer;">
                                </div>
                            </div>
                        </div>
                        <div class="d-grid gap-3">
                            <div class="privacy-toggle-row @(!currentUser.IsProfilePublic ? "opacity-50 grayscale" : "")">
                                <div class="d-flex align-items-center gap-3">
                                    <div class="icon-box"><i class="bi bi-controller"></i></div>
                                    <div>
                                        <span class="fw-bold d-block text-dark">Standoff 2 ID</span>
                                        <small class="text-muted">Показывать ваш игровой ID</small>
                                    </div>
                                </div>
                                <div class="form-check form-switch">
                                    <input class="form-check-input fs-5" type="checkbox" @bind="currentUser.IsGameIdPublic" disabled="@(!currentUser.IsProfilePublic)">
                                </div>
                            </div>
                            <div class="privacy-toggle-row @(!currentUser.IsProfilePublic ? "opacity-50 grayscale" : "")">
                                <div class="d-flex align-items-center gap-3">
                                    <div class="icon-box"><i class="bi bi-chat-quote-fill"></i></div>
                                    <div>
                                        <span class="fw-bold d-block text-dark">Блог и комментарии</span>
                                        <small class="text-muted">Разрешить оставлять записи на стене</small>
                                    </div>
                                </div>
                                <div class="form-check form-switch">
                                    <input class="form-check-input fs-5" type="checkbox" @bind="currentUser.IsBlogEnabled" disabled="@(!currentUser.IsProfilePublic)">
                                </div>
                            </div>
                            <div class="privacy-toggle-row @(!currentUser.IsProfilePublic ? "opacity-50 grayscale" : "")">
                                <div class="d-flex align-items-center gap-3">
                                    <div class="icon-box"><i class="bi bi-wallet2"></i></div>
                                    <div>
                                        <span class="fw-bold d-block text-dark">Стоимость портфеля</span>
                                        <small class="text-muted">Показывать общую сумму</small>
                                    </div>
                                </div>
                                <div class="form-check form-switch">
                                    <input class="form-check-input fs-5" type="checkbox" @bind="currentUser.ShowPortfolioValue" disabled="@(!currentUser.IsProfilePublic)">
                                </div>
                            </div>
                            <div class="privacy-toggle-row @(!currentUser.IsProfilePublic ? "opacity-50 grayscale" : "")">
                                <div class="d-flex align-items-center gap-3">
                                    <div class="icon-box"><i class="bi bi-trophy"></i></div>
                                    <div>
                                        <span class="fw-bold d-block text-dark">Топ предметов</span>
                                        <small class="text-muted">Показывать 3 самых дорогих скина</small>
                                    </div>
                                </div>
                                <div class="form-check form-switch">
                                    <input class="form-check-input fs-5" type="checkbox" @bind="currentUser.ShowTopItems" disabled="@(!currentUser.IsProfilePublic)">
                                </div>
                            </div>
                        </div>
                        <div class="d-flex justify-content-end mt-5">
                            <button class="btn btn-primary fw-bold px-4 py-2 rounded-pill shadow-sm transition hover-scale" @onclick="SaveChanges">
                                Применить настройки
                            </button>
                        </div>
                    }

                    @* --- 4. БЕЗОПАСНОСТЬ (ОБНОВЛЕНО) --- *@
                    @if (activeTab == "security")
                    {
                        <h5 class="fw-bold mb-4">🔑 Безопасность</h5>

                        <div class="d-grid gap-3">
                            <a href="Identity/Account/Manage/ChangePassword" class="text-decoration-none">
                                <div class="p-3 border rounded-4 d-flex align-items-center justify-content-between hover-shadow transition bg-white">
                                    <div class="d-flex align-items-center gap-3">
                                        <div class="bg-primary bg-opacity-10 p-2 rounded-circle text-primary">
                                            <i class="bi bi-shield-lock-fill fs-5"></i>
                                        </div>
                                        <div>
                                            <div class="fw-bold text-dark">Сменить пароль</div>
                                            <small class="text-muted">Рекомендуем менять каждые 3 месяца</small>
                                        </div>
                                    </div>
                                    <i class="bi bi-chevron-right text-muted"></i>
                                </div>
                            </a>
                        </div>

                        <h6 class="fw-bold mt-5 mb-3">🔗 Привязанные аккаунты</h6>
                        <div class="p-3 border rounded-4 d-flex align-items-center justify-content-between bg-white shadow-sm">
                            <div class="d-flex align-items-center gap-3">
                                <div class="p-2 rounded-circle bg-light border">
                                    <i class="bi bi-google fs-4" style="color: #EA4335;"></i>
                                </div>
                                <div>
                                    <div class="fw-bold text-dark">Google</div>

                                    @if (currentLogins.Any(l => l.LoginProvider == "Google"))
                                    {
                                        <span class="badge bg-success bg-opacity-10 text-success rounded-pill px-2">
                                            <i class="bi bi-check-circle-fill me-1"></i>Подключено
                                        </span>
                                    }
                                    else
                                    {
                                        <span class="badge bg-secondary bg-opacity-10 text-secondary rounded-pill px-2">
                                            Не подключено
                                        </span>
                                    }
                                </div>
                            </div>

                            <a href="Identity/Account/Manage/ExternalLogins" class="btn btn-sm btn-outline-secondary rounded-pill fw-bold px-3">
                                Управлять
                            </a>
                        </div>
                    }

                </div>
            </div>
        </div>
    </div>
</div>

<style>
    /* ... Ваши стили ... */
    .active-tab {
        background-color: #0d6efd !important;
        color: white !important;
        box-shadow: 0 4px 10px rgba(13, 110, 253, 0.2);
    }

    .hover-shadow:hover {
        box-shadow: 0 0.5rem 1.5rem rgba(0, 0, 0, 0.08) !important;
        transform: translateY(-2px);
    }

    .hover-scale:hover {
        transform: scale(1.05);
        transition: transform 0.2s;
    }

    .object-fit-cover {
        object-fit: cover;
    }

    .grayscale {
        filter: grayscale(100%);
    }

    .privacy-toggle-row {
        padding: 1rem;
        border: 1px solid #dee2e6;
        border-radius: 1rem;
        display: flex;
        justify-content: space-between;
        align-items: center;
        transition: all 0.2s;
    }

        .privacy-toggle-row:hover {
            background-color: #f8f9fa;
        }

    .icon-box {
        background: #f8f9fa;
        padding: 0.5rem;
        border-radius: 50%;
        color: #6c757d;
    }

    /* Рамки и Скины */
    .avatar-preview-container {
        width: 110px;
        height: 110px;
        border-radius: 50%;
        padding: 3px;
        position: relative;
    }

        .avatar-preview-container.default {
            border: 3px solid #fff;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .avatar-preview-container.gold {
            border: 3px solid #FFD700;
            box-shadow: 0 0 15px rgba(255, 215, 0, 0.5);
        }

        .avatar-preview-container.neon {
            border: 3px solid #00f3ff;
            box-shadow: 0 0 15px rgba(0, 243, 255, 0.5);
        }

        .avatar-preview-container.fire {
            border: 3px solid #ff4500;
            box-shadow: 0 0 15px rgba(255, 69, 0, 0.5);
        }

    .avatar-frame-select {
        width: 80px;
        height: 80px;
        border-radius: 50%;
        padding: 4px;
        border: 2px solid transparent;
        transition: all 0.2s;
    }

        .avatar-frame-select.selected {
            border-color: #0d6efd;
            transform: scale(1.1);
        }

    .frame-preview {
        width: 100%;
        height: 100%;
        border-radius: 50%;
        overflow: hidden;
    }

        .frame-preview.default {
            border: 2px solid #ccc;
        }

        .frame-preview.gold {
            border: 3px solid #FFD700;
        }

        .frame-preview.neon {
            border: 3px solid #00f3ff;
        }

        .frame-preview.fire {
            border: 3px solid #ff4500;
        }

        .frame-preview img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

    .inventory-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));
        gap: 1rem;
    }

    .skin-selector-card {
        background: #fff;
        border: 2px solid #f1f5f9;
        border-radius: 12px;
        padding: 10px;
        text-align: center;
        cursor: pointer;
        position: relative;
        transition: all 0.2s;
    }

        .skin-selector-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.05);
        }

        .skin-selector-card.active {
            border-color: #0d6efd;
            background-color: #f0f7ff;
        }

    .skin-img img {
        width: 100%;
        height: auto;
        max-height: 60px;
        object-fit: contain;
        margin-bottom: 5px;
    }

    .skin-name {
        font-size: 0.75rem;
        font-weight: bold;
        color: #334155;
    }

    .check-indicator {
        position: absolute;
        top: 5px;
        right: 5px;
        width: 20px;
        height: 20px;
        background: #0d6efd;
        color: white;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 0.8rem;
    }
</style>

@code {
    private string activeTab = "general";
    private ApplicationUser currentUser = new();

    // Для кастомизации
    private List<InventoryItem> userInventory = new();
    private List<int> selectedSkinIds = new();

    // 🔥 Список привязанных логинов
    private IList<UserLoginInfo> currentLogins = new List<UserLoginInfo>();

    record FrameOption(string Id, string Name);
    private List<FrameOption> availableFrames = new()
    {
        new("default", "Обычная"),
        new("gold", "Gold"),
        new("neon", "Neon"),
        new("fire", "Fire")
    };

    protected override async Task OnInitializedAsync()
    {
        var authState = await AuthStateProvider.GetAuthenticationStateAsync();
        var principal = authState.User;

        if (principal.Identity?.IsAuthenticated == true)
        {
            using (var scope = ScopeFactory.CreateScope())
            {
                var userManager = scope.ServiceProvider.GetRequiredService<UserManager<ApplicationUser>>();
                var portfolioService = scope.ServiceProvider.GetRequiredService<PortfolioService>();

                var user = await userManager.GetUserAsync(principal);
                if (user != null)
                {
                    currentUser = user;
                    currentUser.PortfolioGoal = Math.Round(currentUser.PortfolioGoal, 2);

                    // 🔥 Получаем список внешних логинов (Google, etc.)
                    currentLogins = await userManager.GetLoginsAsync(user);

                    // 1. Загружаем инвентарь
                    var portfolios = await portfolioService.GetPortfoliosByUserAsync(user.Id);
                    foreach (var p in portfolios)
                    {
                        var items = await portfolioService.GetInventoryAsync(p.Id);
                        foreach (var i in items)
                        {
                            if (!userInventory.Any(x => x.ItemBaseId == i.ItemBaseId))
                            {
                                userInventory.Add(i);
                            }
                        }
                    }

                    // 2. Десериализуем скины
                    if (!string.IsNullOrEmpty(user.FavoriteSkinsJson))
                    {
                        try
                        {
                            selectedSkinIds = JsonSerializer.Deserialize<List<int>>(user.FavoriteSkinsJson) ?? new();
                        }
                        catch { }
                    }
                }
            }
        }
    }

    private void ToggleFavoriteSkin(int skinId)
    {
        if (selectedSkinIds.Contains(skinId))
        {
            selectedSkinIds.Remove(skinId);
        }
        else
        {
            if (selectedSkinIds.Count >= 4)
            {
                ToastService.ShowToast("Максимум 4 скина!", StandoffPortfolioTracker.AdminPanel.Services.ToastLevel.Warning);
                return;
            }
            selectedSkinIds.Add(skinId);
        }
    }

    private async Task SaveChanges()
    {
        using (var scope = ScopeFactory.CreateScope())
        {
            var userManager = scope.ServiceProvider.GetRequiredService<UserManager<ApplicationUser>>();
            var userInDb = await userManager.FindByIdAsync(currentUser.Id);

            if (userInDb != null)
            {
                // Основное
                userInDb.DisplayName = currentUser.DisplayName;
                userInDb.PortfolioGoal = Math.Round(currentUser.PortfolioGoal, 2);
                userInDb.AvatarUrl = currentUser.AvatarUrl;
                userInDb.StandoffGameId = currentUser.StandoffGameId;

                // Приватность
                userInDb.IsProfilePublic = currentUser.IsProfilePublic;
                userInDb.ShowPortfolioValue = currentUser.ShowPortfolioValue;
                userInDb.ShowGrowth = currentUser.ShowGrowth;
                userInDb.ShowTopItems = currentUser.ShowTopItems;
                userInDb.IsGameIdPublic = currentUser.IsGameIdPublic;
                userInDb.IsBlogEnabled = currentUser.IsBlogEnabled;

                // Кастомизация
                userInDb.ProfileFrame = currentUser.ProfileFrame;
                userInDb.FavoriteSkinsJson = JsonSerializer.Serialize(selectedSkinIds);

                var result = await userManager.UpdateAsync(userInDb);
                if (result.Succeeded)
                {
                    ToastService.ShowToast("Настройки успешно сохранены!", StandoffPortfolioTracker.AdminPanel.Services.ToastLevel.Success);
                    currentUser = userInDb;
                }
                else
                {
                    ToastService.ShowToast("Ошибка при сохранении.", StandoffPortfolioTracker.AdminPanel.Services.ToastLevel.Error);
                }
            }
        }
    }

    private string GetProfileUrl() => $"{NavManager.BaseUri}profile/{currentUser.Id}";

    private async Task HandleFileSelected(InputFileChangeEventArgs e)
    {
        var file = e.File;
        if (file != null)
        {
            if (file.Size > 2 * 1024 * 1024)
            {
                ToastService.ShowToast("Файл слишком большой! Макс 2MB.", StandoffPortfolioTracker.AdminPanel.Services.ToastLevel.Warning);
                return;
            }
            try
            {
                var fileName = $"{currentUser.Id}_{Guid.NewGuid()}{Path.GetExtension(file.Name)}";
                var path = Path.Combine(Environment.WebRootPath, "uploads", "avatars", fileName);
                Directory.CreateDirectory(Path.GetDirectoryName(path)!);
                await using var stream = new FileStream(path, FileMode.Create);
                await file.OpenReadStream(2 * 1024 * 1024).CopyToAsync(stream);
                currentUser.AvatarUrl = $"/uploads/avatars/{fileName}";
            }
            catch (Exception ex)
            {
                Console.WriteLine($"Error: {ex.Message}");
                ToastService.ShowToast("Ошибка загрузки фото.", StandoffPortfolioTracker.AdminPanel.Services.ToastLevel.Error);
            }
        }
    }
}